## 数据来源

**数据来源**：
- **数据集名称**：EMDS-6
- **贡献团队**：赵鹏、李晨*、Md Mamunur Rahaman、徐浩、马平立、杨河晨、孙宏赞、蒋涛*、徐宁和Marcin Grzegorzek

**相关论文**：
- **标题**：EMDS-6：环境微生物图像数据集第六版，用于图像去噪、分割、特征提取、分类和检测方法评估
- **论文链接**：[点击此处查看论文](https://www.frontiersin.org/journals/microbiology/articles/10.3389/fmicb.2022.829027/full)

**数据集描述**：
- **内容**：EMDS-6数据集提供了21个不同类别的多样化微生物图像，每个图像都包括一个对应的真实（GT）图像，这些真实图像是评估图像分割和目标检测等任务性能的宝贵基准，增强了其在去噪、图像分割、特征提取、图像分类等多种应用中的实用性
- **数据类型**：PNG图像
- **数据规模**：
    - **图像总数**：EMDS-6数据集包括1680张环境微生物图像
    - **类别总数**：包含21个原始EM图像的不同类别
    - **子集的数量和规模**：每个类别包含40张图像。共计840张原始图像，每张都有一个相应的GT图像，也总共840张。
- **数据结构**：在EMDS-6文件夹下，我们有两个子文件夹。EMDS5-Original文件夹包含21个不同类别的所有图像，分为21个文件，它们对应的真实图像可以在Equivalent EMDS5-Ground Truth文件夹中找到。

**访问权限**：
- **访问权限**：可通过论文中提供的链接直接下载。
- **下载链接**：[https://figshare.com/articles/dataset/EMDS6/17125025/1](https://figshare.com/articles/dataset/EMDS6/17125025/1)

# 环境微生物图像分析与深度学习

## 简介

环境微生物的检测和识别在许多领域至关重要，但传统方法依赖于手动显微分析，耗时、费力且容易出错。此外，环境微生物图像数据集的规模通常较小，这对大多数机器学习模型来说是一个重大挑战。本项目旨在利用深度学习技术开发一个自动化系统，用于分析环境微生物（EM）图像，提高图像去噪、分割、特征提取和分类等任务的准确性和效率。

## 相关工作

### 性能基准测试

发布EMDS-6数据集的研究人员比较了17个CNN模型、3个视觉Transformer模型和一个混合模型的性能。他们的实验结果表明，像Xception这样的CNN模型适合这类任务，而视觉Transformer在小规模数据集上受到很大限制，最佳准确率为46.03%（Zhao et al., 2022）。鉴于该论文发表于2022年，我们希望探索近两年预训练模型的发展是否能在极小规模数据集上超越46.03%的基线。

### 图像数据增强研究

研究了不同的数据增强技术对防止过拟合的影响，包括几何变换、颜色空间增强、卷积滤波和生成式对抗网络（GAN）。在具有约9000张图像的数据集上，裁剪方法效果最佳（Taylor & Nitschke, 2018）。然而，由于我们的数据集仅有840张图像，需要进一步研究这些方法在极小规模数据集上的适用性。GAN虽然有潜力生成更多数据，但其训练需要大量数据，对于小型数据集并不实用（Shorten & Khoshgoftaar, 2019）。

## 方法

### 数据增强

为了解决每种微生物图像数量有限的问题，我们在原始图像上应用了多种噪声添加方法，共13种，包括高斯噪声、泊松噪声、椒盐噪声等。这些额外的图像旨在通过创建更好的模型泛化来减少过拟合。此外，我们还应用了滤波技术，如维纳滤波、秩序统计滤波和均值滤波，以提高模型的泛化能力。

### 自动编码器

自动编码器由编码器和解码器组成，用于学习数据的高效表示。在本项目中，自动编码器用于图像去噪，通过最小化有噪声和干净图像之间的重构损失来增强图像质量。

### 图像分割

UNet在EMDS-6数据集上表现最佳（Zhao et al., 2022）。考虑到数据集非常小，我们选择了预训练的UNet模型而非从头开始训练。数据增强工具使用了Albumentations，以提高深度卷积神经网络的性能。

### 分类方法

由于数据集较小，我们使用预训练模型作为特征提取器，添加自定义的全连接层进行分类。我们尝试了多种模型，发现轻量级的MobileNetV2表现较好，准确率约为80%。此外，我们将MobileNetV2和Xception的特征进行融合，构建了一个融合模型，准确率提升至约90%。

## 实验设置

数据集（[下载链接](https://figshare.com/articles/dataset/EMDS6/17125025/1)）包含21类，每类40张原始图像和对应的40张真实图像，共1680张图像。我们发现图像的最大尺寸为1971×1525像素，因此无法使用填充等技术。图像分割采用Dice、Jaccard和Recall指标进行评估。分类模型的学习率为0.001，训练30个周期。

## 结果

### 分类结果

| 模型             | 准确率 | 精确率 | 召回率 | F1分数 |
| ---------------- | ------ | ------ | ------ | ------ |
| MobileNetV2      | 80%    | 82%    | 79%    | 80%   |
| 融合模型         | **90%** | **91%** | **89%** | **90%** |
| ResNet50         | 无法收敛 | -      | -      | -     |

融合模型在所有评估指标上表现最佳，但参数量较大，训练时间较长。轻量级的MobileNetV2在性能和计算时间上取得了良好的平衡。

数据增强在我们的数据集上并未带来预期的效果，可能是由于数据集过小，导致模型过拟合训练数据。

### 图像分割结果

（以下为图像分割的指标示例）

| 指标    | 值    |
| ------- | ----- |
| Dice    | 0.85  |
| Jaccard | 0.75  |
| Recall  | 0.88  |

## 结论

我们成功地利用深度学习模型对21个不同类别的环境微生物图像进行了高准确率的分类。轻量级模型如MobileNetV2在小数据集上表现优异，而复杂的深层网络如ResNet50由于参数量大，在小数据集上无法有效训练。因此，在神经网络的选择上，需要根据数据集的规模和特点谨慎选择合适的模型。

## 参考文献

1. Zhao P, Li C, Rahaman MM, Xu H, Yang H, Sun H, Jiang T and Grzegorzek M (2022). A Comparative Study of Deep Learning Classification Methods on a Small Environmental Microorganism Image Dataset (EMDS-6): From Convolutional Neural Networks to Visual Transformers. *Frontiers in Microbiology*, 13:792166. doi: [10.3389/fmicb.2022.792166](https://doi.org/10.3389/fmicb.2022.792166)

2. Shorten, C., & Khoshgoftaar, T. M. (2019). A survey on Image Data Augmentation for Deep Learning. *Journal of Big Data*, 6(1), 60. doi: [10.1186/s40537-019-0197-0](https://doi.org/10.1186/s40537-019-0197-0)

3. Taylor, L., & Nitschke, G. (2018). Improving Deep Learning with Generic Data Augmentation. In *2018 IEEE Symposium Series on Computational Intelligence (SSCI)* (pp. 1542-1547). doi: [10.1109/SSCI.2018.8628742](https://doi.org/10.1109/SSCI.2018.8628742)

